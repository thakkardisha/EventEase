<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:head>
        <title>#{categoryEventsBean.category.cName} Events - EventEase</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                background-color: #0b043a !important;
                color: #F4F0F8;
                font-family: "Segoe UI", Arial, sans-serif;
                overflow-x: hidden;
            }

            /* Header */
            .category-header {
                background: rgba(255, 255, 255, 0.06);
                backdrop-filter: blur(6px);
                padding: 15px 40px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                position: sticky;
                top: 0;
                z-index: 1000;
            }

            .logo-img {
                height: 45px;
                cursor: pointer;
            }

            /* Category Banner */
            .category-banner {
                background: linear-gradient(135deg, rgba(168, 155, 191, 0.3), rgba(200, 184, 232, 0.2));
                padding: 60px 40px;
                text-align: center;
                margin-bottom: 40px;
            }

            .category-title {
                font-size: 48px;
                font-weight: bold;
                color: #C8B8E8;
                margin-bottom: 15px;
            }

            .category-description {
                font-size: 18px;
                color: #E0D5F0;
                max-width: 800px;
                margin: 0 auto;
            }

            .event-count {
                margin-top: 15px;
                font-size: 16px;
                color: #A89BBF;
            }

            /* Main Container */
            .events-container {
                max-width: 1400px;
                margin: 0 auto 60px;
                padding: 0 40px;
            }

            /* Events Grid */
            .events-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: 30px;
                margin-top: 30px;
            }

            /* Event Card */
            .event-card {
                background: rgba(255, 255, 255, 0.06);
                backdrop-filter: blur(10px);
                border-radius: 16px;
                overflow: hidden;
                transition: all 0.3s;
                box-shadow: 0 4px 20px rgba(0,0,0,0.2);
                cursor: pointer;
            }

            .event-card:hover {
                transform: translateY(-8px);
                box-shadow: 0 8px 30px rgba(168, 155, 191, 0.4);
            }

            .event-image {
                width: 100%;
                height: 200px;
                object-fit: cover;
            }

            .event-content {
                padding: 20px;
            }

            .event-name {
                font-size: 20px;
                font-weight: bold;
                color: #F4F0F8;
                margin-bottom: 12px;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .event-info {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                color: #C8B8E8;
                font-size: 14px;
            }

            .event-info i {
                width: 16px;
                color: #A89BBF;
            }

            .event-description {
                color: #E0D5F0;
                font-size: 14px;
                margin-top: 12px;
                display: -webkit-box;
                -webkit-line-clamp: 3;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .event-footer {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding-top: 15px;
                margin-top: 15px;
                border-top: 1px solid rgba(168, 155, 191, 0.2);
            }

            .event-price {
                font-size: 24px;
                font-weight: bold;
                color: #C8B8E8;
            }

            .view-button {
                padding: 10px 20px;
                background: linear-gradient(135deg, #A89BBF, #8B7BA8);
                border: none;
                border-radius: 8px;
                color: #F4F0F8;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s;
            }

            .view-button:hover {
                transform: scale(1.05);
                box-shadow: 0 4px 15px rgba(168, 155, 191, 0.4);
            }

            /* No Events */
            .no-events {
                text-align: center;
                padding: 80px 20px;
            }

            .no-events i {
                font-size: 64px;
                color: #A89BBF;
                opacity: 0.5;
                margin-bottom: 20px;
            }

            .no-events h3 {
                font-size: 24px;
                color: #C8B8E8;
                margin-bottom: 10px;
            }

            .no-events p {
                color: #A89BBF;
                font-size: 16px;
            }

            /* Footer */
            .footer {
                background: rgba(255, 255, 255, 0.04);
                padding: 25px 40px;
                text-align: center;
                color: #c8c0d8;
                font-size: 14px;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }

            /* Responsive */
            @media (max-width: 768px) {
                .events-container {
                    padding: 0 20px;
                }

                .category-title {
                    font-size: 32px;
                }

                .events-grid {
                    grid-template-columns: 1fr;
                }
            }
        </style>
    </h:head>

    <h:body>
        <p:growl id="msgs" showDetail="true" life="3000"/>

        <!-- Header -->
        <div class="category-header">
            <h:graphicImage library="images" name="EventEase.png" 
                            styleClass="logo-img" 
                            alt="EventEase"
                            onclick="window.location = 'home.jsf'"/>
        </div>

        <!-- Category Banner -->
        <div class="category-banner">
            <h1 class="category-title">#{categoryEventsBean.category.cName}</h1>
            <p class="category-description">#{categoryEventsBean.category.cDescription}</p>
            <p class="event-count">
                <i class="fas fa-ticket-alt"></i>
                #{categoryEventsBean.events.size()} Events Available
            </p>
        </div>

        <!-- Events Container -->
        <div class="events-container">
            <h:form id="eventsForm">
                <!-- Events Grid -->
                <p:outputPanel rendered="#{not empty categoryEventsBean.events}">
                    <div class="events-grid">
                        <ui:repeat value="#{categoryEventsBean.events}" var="event">
                            <div class="event-card" onclick="window.location = 'event-details.jsf?eId=#{event.eId}'">
                                <h:graphicImage value="/#{event.bannerImg}" 
                                                styleClass="event-image"
                                                alt="#{event.eName}"/>

                                <div class="event-content">
                                    <h3 class="event-name">#{event.eName}</h3>

                                    <div class="event-info">
                                        <i class="far fa-calendar-alt"></i>
                                        <h:outputText value="#{event.eventDate}">
                                            <f:converter converterId="localDateConverter"/>
                                        </h:outputText>
                                    </div>

                                    <div class="event-info">
                                        <i class="far fa-clock"></i>
                                        <h:outputText value="#{event.startTime}"/>
                                    </div>

                                    <div class="event-info">
                                        <i class="fas fa-map-marker-alt"></i>
                                        #{event.vId.vName}, #{event.vId.vCity}
                                    </div>

                                    <p class="event-description">#{event.eDescription}</p>

                                    <div class="event-footer">
                                        <span class="event-price">
                                            ₹<h:outputText value="#{event.unitPrice}">
                                                <f:convertNumber type="number" groupingUsed="true"/>
                                            </h:outputText>
                                        </span>
                                        <button type="button" class="view-button" 
                                                onclick="window.location = 'event-details.jsf?eId=#{event.eId}'">
                                            View Details
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </ui:repeat>
                    </div>
                </p:outputPanel>

                <!-- No Events -->
                <p:outputPanel rendered="#{empty categoryEventsBean.events}">
                    <div class="no-events">
                        <i class="fas fa-calendar-times"></i>
                        <h3>No Events Available</h3>
                        <p>There are currently no events in this category. Check back soon!</p>
                    </div>
                </p:outputPanel>
            </h:form>
        </div>

        <!-- Footer -->
        <div class="footer">
            © 2025 EventEase. All rights reserved.
        </div>
    </h:body>
</html>