<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:head>
        <title>My Bookings - EventEase</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                background-color: #0b043a !important;
                color: #F4F0F8;
                font-family: "Segoe UI", Arial, sans-serif;
                overflow-x: hidden;
            }

            /* Header */
            .bookings-header {
                background: #0b043a !important;
                backdrop-filter: blur(6px);
                padding: 15px 40px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: 0 2px 10px rgba(1,1,1,1.2);
                position: sticky;
                top: 0;
                z-index: 1000;
            }

            .logo-img {
                height: 55px;
                cursor: pointer;
            }

            .header-title {
                color: #C8B8E8;
                font-size: 24px;
                font-weight: bold;
            }

            /* Main Container */
            .bookings-container {
                max-width: 1200px;
                margin: 40px auto;
                padding: 0 40px;
            }

            .page-title {
                font-size: 36px;
                color: #C8B8E8;
                margin-bottom: 10px;
                text-align: center;
            }

            .page-subtitle {
                text-align: center;
                color: #A89BBF;
                margin-bottom: 40px;
                font-size: 16px;
            }

            /* Booking Cards */
            .bookings-grid {
                display: grid;
                gap: 25px;
            }

            .booking-card {
                background: rgba(255, 255, 255, 0.06);
                backdrop-filter: blur(10px);
                border-radius: 16px;
                padding: 25px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.2);
                border: 1px solid rgba(168, 155, 191, 0.2);
                transition: all 0.3s;
            }

            .booking-card:hover {
                border-color: rgba(168, 155, 191, 0.5);
                transform: translateY(-2px);
                box-shadow: 0 6px 25px rgba(0,0,0,0.3);
            }

            .booking-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 20px;
                gap: 20px;
            }

            .booking-main-info {
                flex: 1;
            }

            .booking-id {
                font-size: 14px;
                color: #A89BBF;
                margin-bottom: 8px;
            }

            .event-name {
                font-size: 24px;
                font-weight: bold;
                color: #F4F0F8;
                margin-bottom: 5px;
            }

            .booking-date {
                font-size: 13px;
                color: #C8B8E8;
            }

            .status-badge {
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 13px;
                font-weight: bold;
                white-space: nowrap;
            }

            .status-upcoming {
                background: rgba(76, 175, 80, 0.2);
                color: #4CAF50;
            }

            .status-completed {
                background: rgba(158, 158, 158, 0.2);
                color: #9E9E9E;
            }

            .booking-details {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin-bottom: 20px;
                padding: 20px;
                background: rgba(255, 255, 255, 0.03);
                border-radius: 12px;
            }

            .detail-item {
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .detail-icon {
                color: #A89BBF;
                font-size: 16px;
                width: 24px;
            }

            .detail-content {
                flex: 1;
            }

            .detail-label {
                font-size: 12px;
                color: #A89BBF;
                margin-bottom: 3px;
            }

            .detail-value {
                font-size: 15px;
                color: #F4F0F8;
                font-weight: 500;
            }

            .booking-footer {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding-top: 20px;
                border-top: 1px solid rgba(168, 155, 191, 0.2);
            }

            .total-amount {
                font-size: 16px;
                color: #C8B8E8;
            }

            .total-amount .amount {
                font-size: 24px;
                font-weight: bold;
                margin-left: 8px;
            }

            .download-btn {
                padding: 12px 24px !important;
                background: linear-gradient(135deg, #A89BBF, #8B7BA8) !important;
                border: none !important;
                border-radius: 8px !important;
                color: #F4F0F8 !important;
                font-weight: bold !important;
                cursor: pointer;
                transition: all 0.3s;
            }

            .download-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(168, 155, 191, 0.6);
            }

            /* Empty State */
            .empty-state {
                text-align: center;
                padding: 80px 20px;
                background: rgba(255, 255, 255, 0.04);
                border-radius: 16px;
            }

            .empty-icon {
                font-size: 80px;
                color: #A89BBF;
                opacity: 0.5;
                margin-bottom: 20px;
            }

            .empty-title {
                font-size: 24px;
                color: #C8B8E8;
                margin-bottom: 10px;
            }

            .empty-text {
                font-size: 16px;
                color: #A89BBF;
                margin-bottom: 30px;
            }

            .browse-btn {
                padding: 14px 32px !important;
                background: linear-gradient(135deg, #A89BBF, #8B7BA8) !important;
                border: none !important;
                border-radius: 10px !important;
                color: #F4F0F8 !important;
                font-size: 16px !important;
                font-weight: bold !important;
                text-decoration: none;
                display: inline-block;
            }

            /* Footer */
            .footer {
                background: rgba(255, 255, 255, 0.04);
                padding: 25px 40px;
                text-align: center;
                color: #c8c0d8;
                font-size: 14px;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                margin-top: 60px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .bookings-container {
                    padding: 0 20px;
                }

                .booking-header {
                    flex-direction: column;
                    gap: 15px;
                }

                .status-badge {
                    align-self: flex-start;
                }

                .booking-details {
                    grid-template-columns: 1fr;
                }

                .booking-footer {
                    flex-direction: column;
                    gap: 15px;
                    align-items: flex-start;
                }

                .download-btn {
                    width: 100%;
                }
            }
        </style>
    </h:head>

    <h:body>
        <p:growl id="msgs" showDetail="true" life="3000"/>

        <!-- Header -->
        <div class="bookings-header">
            <h:graphicImage library="images" name="EventEase.png" 
                            styleClass="logo-img" 
                            alt="EventEase"
                            onclick="window.location = 'Home.jsf'"/>

<!--            <div class="header-title">My Bookings</div>-->
        </div>

        <!-- Main Content -->
        <div class="bookings-container">
            <h1 class="page-title">My Bookings</h1>
            <p class="page-subtitle">View and manage all your event bookings</p>

            <h:form id="bookingsForm">
                <!-- Bookings List -->
                <p:outputPanel rendered="#{not empty bookingBean.myBookings}">
                    <div class="bookings-grid">
                        <ui:repeat value="#{bookingBean.myBookings}" var="booking">
                            <div class="booking-card">
                                <div class="booking-header">
                                    <div class="booking-main-info">
                                        <div class="booking-id">
<!--                                            Booking ##{booking.bId} • -->
                                            Booked on <h:outputText value="#{booking.bookingDate}">
                                                <f:convertDateTime pattern="dd MMM yyyy" />
                                            </h:outputText>
                                        </div>
                                        <div class="event-name">#{booking.eId.eName}</div>
                                    </div>
                                    <span class="status-badge #{bookingBean.getStatusClass(booking)}">
                                        #{bookingBean.getBookingStatus(booking)}
                                    </span>
                                </div>

                                <div class="booking-details">
                                    <div class="detail-item">
                                        <i class="far fa-calendar-alt detail-icon"></i>
                                        <div class="detail-content">
                                            <div class="detail-label">Event Date</div>
                                            <div class="detail-value">
                                                <h:outputText value="#{booking.eId.eventDate}">
                                                    <f:converter converterId="localDateConverter"/>
                                                </h:outputText>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="detail-item">
                                        <i class="far fa-clock detail-icon"></i>
                                        <div class="detail-content">
                                            <div class="detail-label">Time</div>
                                            <div class="detail-value">#{booking.eId.startTime}</div>
                                        </div>
                                    </div>

                                    <div class="detail-item">
                                        <i class="fas fa-map-marker-alt detail-icon"></i>
                                        <div class="detail-content">
                                            <div class="detail-label">Venue</div>
                                            <div class="detail-value">
                                                #{booking.eId.vId.vName}, #{booking.eId.vId.vCity}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="detail-item">
                                        <i class="fas fa-ticket-alt detail-icon"></i>
                                        <div class="detail-content">
                                            <div class="detail-label">Tickets</div>
                                            <div class="detail-value">#{booking.ticketCount} Ticket(s)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="booking-footer">
                                    <div class="total-amount">
                                        Total Paid: 
                                        <span class="amount">
                                            ₹<h:outputText value="#{booking.totalAmount}">
                                                <f:convertNumber type="number" groupingUsed="true"/>
                                            </h:outputText>
                                        </span>
                                    </div>

                                    <p:commandButton value="Download Tickets" 
                                                     styleClass="download-btn"
                                                     icon="fas fa-download"
                                                     actionListener="#{ticketDownloadBean.downloadTickets(booking.bId)}"
                                                     ajax="false"/>
                                </div>
                            </div>
                        </ui:repeat>
                    </div>
                </p:outputPanel>

                <!-- Empty State -->
                <p:outputPanel rendered="#{empty bookingBean.myBookings}">
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-ticket-alt"></i>
                        </div>
                        <h2 class="empty-title">No Bookings Yet</h2>
                        <p class="empty-text">
                            You haven't booked any events yet. Start exploring amazing events!
                        </p>
                        <a href="Home.jsf" class="browse-btn">
                            <i class="fas fa-search"></i> Browse Events
                        </a>
                    </div>
                </p:outputPanel>
            </h:form>
        </div>

        <!-- Footer -->
        <div class="footer">
            © 2025 EventEase. All rights reserved.
        </div>
    </h:body>
</html>