<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:head>
        <title>Search Results - EventEase</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                background-color: #0b043a !important;
                color: #F4F0F8;
                font-family: "Segoe UI", Arial, sans-serif;
                overflow-x: hidden;
            }

            /* Header */
            .search-header {
                background: #0b043a !important;
                backdrop-filter: blur(6px);
                padding: 15px 40px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: 0 2px 10px rgba(1,1,1,1.2);
                position: sticky;
                top: 0;
                z-index: 1000;
            }

            .logo-img {
                height: 55px;
                cursor: pointer;
            }

            .header-search {
                flex: 1;
                max-width: 600px;
                margin: 0 40px;
            }

            .search-input-wrapper {
                display: flex;
                gap: 10px;
            }

            .search-input-wrapper .ui-inputfield {
                flex: 1;
                padding: 12px 20px;
                border-radius: 25px;
                border: 1px solid #A89BBF;
                background: rgba(255,255,255,0.08) !important;
                color: #F4F0F8 !important;
                font-size: 16px;
            }

            .search-btn {
                padding: 12px 30px !important;
                background: linear-gradient(135deg, #A89BBF, #8B7BA8) !important;
                border: none !important;
                border-radius: 25px !important;
                color: #F4F0F8 !important;
                font-weight: bold !important;
                cursor: pointer;
            }

            .back-btn {
                padding: 10px 20px !important;
                background: rgba(168, 155, 191, 0.2) !important;
                border: 1px solid #A89BBF !important;
                border-radius: 8px !important;
                color: #F4F0F8 !important;
                font-weight: bold !important;
            }

            /* Main Content */
            .search-container {
                max-width: 1200px;
                margin: 40px auto;
                padding: 0 40px;
            }

            .search-info {
                margin-bottom: 30px;
            }

            .search-query {
                font-size: 22px;
                color: #C8B8E8;
                margin-bottom: 10px;
            }

            .search-query-text {
                color: #F4F0F8;
                font-weight: bold;
            }

            .results-count {
                font-size: 16px;
                color: #A89BBF;
            }

            /* Filter Section */
            .filter-section {
                background: rgba(255, 255, 255, 0.06);
                padding: 20px;
                border-radius: 12px;
                margin-bottom: 30px;
            }

            .filter-title {
                font-size: 18px;
                color: #C8B8E8;
                margin-bottom: 15px;
                font-weight: bold;
            }

            .filter-info {
                font-size: 14px;
                color: #A89BBF;
                line-height: 1.6;
            }

            /* Results Grid */
            .results-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 25px;
                margin-bottom: 40px;
            }

            .event-card {
                background: rgba(255, 255, 255, 0.08);
                border-radius: 12px;
                overflow: hidden;
                cursor: pointer;
                transition: all 0.3s;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                border: 1px solid rgba(168, 155, 191, 0.2);
            }

            .event-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 25px rgba(0,0,0,0.3);
                border-color: rgba(168, 155, 191, 0.5);
            }

            .event-banner {
                width: 100%;
                height: 180px;
                object-fit: cover;
            }

            .event-info {
                padding: 20px;
            }

            .event-name {
                font-size: 18px;
                font-weight: bold;
                color: #F4F0F8;
                margin-bottom: 10px;
                line-height: 1.3;
                min-height: 48px;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .event-details {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }

            .event-detail-row {
                display: flex;
                align-items: center;
                gap: 8px;
                color: #C8B8E8;
                font-size: 14px;
            }

            .event-detail-row i {
                color: #A89BBF;
                width: 16px;
            }

            .event-category {
                display: inline-block;
                padding: 5px 12px;
                background: rgba(168, 155, 191, 0.2);
                border-radius: 15px;
                font-size: 12px;
                color: #C8B8E8;
                margin-top: 10px;
            }

            /* No Results */
            .no-results {
                text-align: center;
                padding: 80px 20px;
                background: rgba(255, 255, 255, 0.04);
                border-radius: 16px;
            }

            .no-results-icon {
                font-size: 80px;
                color: #A89BBF;
                opacity: 0.5;
                margin-bottom: 20px;
            }

            .no-results-title {
                font-size: 28px;
                color: #C8B8E8;
                margin-bottom: 10px;
            }

            .no-results-text {
                font-size: 16px;
                color: #A89BBF;
                margin-bottom: 30px;
            }

            .suggestions {
                text-align: left;
                max-width: 500px;
                margin: 0 auto;
                padding: 20px;
                background: rgba(168, 155, 191, 0.1);
                border-radius: 12px;
            }

            .suggestions-title {
                font-size: 18px;
                color: #C8B8E8;
                margin-bottom: 15px;
                font-weight: bold;
            }

            .suggestions ul {
                list-style: none;
                padding: 0;
            }

            .suggestions li {
                padding: 8px 0;
                color: #E0D5F0;
                font-size: 14px;
                display: flex;
                align-items: flex-start;
                gap: 10px;
            }

            .suggestions li:before {
                content: "•";
                color: #A89BBF;
                font-size: 20px;
                line-height: 1;
            }

            /* Footer */
            .footer {
                background: rgba(255, 255, 255, 0.04);
                padding: 25px 40px;
                text-align: center;
                color: #c8c0d8;
                font-size: 14px;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                margin-top: 60px;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .search-header {
                    flex-direction: column;
                    gap: 15px;
                    padding: 15px 20px;
                }

                .header-search {
                    width: 100%;
                    margin: 0;
                }

                .search-container {
                    padding: 0 20px;
                }

                .results-grid {
                    grid-template-columns: 1fr;
                }

                .search-query {
                    font-size: 24px;
                }
            }
        </style>
    </h:head>

    <h:body>
        <p:growl id="msgs" showDetail="true" life="3000"/>

        <!-- Header -->
        <div class="search-header">
            <h:graphicImage library="images" name="EventEase.png" 
                            styleClass="logo-img" 
                            alt="EventEase"
                            onclick="window.location = 'Home.jsf'"/>

            <h:form styleClass="header-search">
                <div class="search-input-wrapper">
                    <p:inputText placeholder="Search events, artists, categories..." 
                                 value="#{searchResultsBean.searchQuery}"
                                 onkeypress="if (event.keyCode == 13) {
                                             document.getElementById('searchBtn').click();
                                             return false;
                                         }"/>
                    <p:commandButton id="searchBtn"
                                     value="Search" 
                                     styleClass="search-btn"
                                     icon="fas fa-search"
                                     action="#{searchResultsBean.performNewSearch}"
                                     update="@form :resultsForm"/>
                </div>
            </h:form>

            <p:commandButton value="Back" 
                             styleClass="back-btn"
                             icon="fas fa-arrow-left"
                             onclick="window.location = 'Home.jsf'; return false;"/>
        </div>

        <!-- Main Content -->
        <div class="search-container">
            <!-- Search Info -->
            <div class="search-info">
                <h1 class="search-query">
                    Search results for: <span class="search-query-text">"#{searchResultsBean.searchQuery}"</span>
                </h1>
                <p class="results-count">
                    Found #{searchResultsBean.resultCount} event#{searchResultsBean.resultCount != 1 ? 's' : ''}
                </p>
            </div>

            <!-- Filter Info -->
            <div class="filter-section">
                <div class="filter-title">
                    <i class="fas fa-info-circle"></i> Search Information
                </div>
                <p class="filter-info">
                    Your search includes results from event names, artist names, categories, descriptions, and dates. 
                    Results are sorted by event date.
                </p>
            </div>

            <!-- Results -->
            <h:form id="resultsForm">
                <!-- Results Grid -->
                <p:outputPanel rendered="#{not empty searchResultsBean.searchResults}">
                    <div class="results-grid">
                        <ui:repeat value="#{searchResultsBean.searchResults}" var="event">
                            <div class="event-card" 
                                 onclick="window.location = 'event-details.jsf?id=#{event.eId}'">
                                <h:graphicImage value="/#{event.bannerImg}" 
                                                styleClass="event-banner"
                                                alt="#{event.eName}"/>
                                <div class="event-info">
                                    <div class="event-name">#{event.eName}</div>

                                    <div class="event-details">
                                        <div class="event-detail-row">
                                            <i class="far fa-calendar-alt"></i>
                                            <h:outputText value="#{event.eventDate}">
                                                <f:converter converterId="localDateConverter"/>
                                            </h:outputText>
                                        </div>

                                        <div class="event-detail-row">
                                            <i class="far fa-clock"></i>
                                            <h:outputText value="#{event.startTime}"/>
                                        </div>

                                        <div class="event-detail-row">
                                            <i class="fas fa-map-marker-alt"></i>
                                            #{event.vId.vCity}
                                        </div>

                                        <div class="event-detail-row">
                                            <i class="fas fa-rupee-sign"></i>
                                            <h:outputText value="#{event.unitPrice}">
                                                <f:convertNumber type="number" groupingUsed="true"/>
                                            </h:outputText>
                                        </div>
                                    </div>

                                    <span class="event-category">
                                        <i class="fas fa-tag"></i> #{event.cId.cName}
                                    </span>
                                </div>
                            </div>
                        </ui:repeat>
                    </div>
                </p:outputPanel>

                <!-- No Results -->
                <p:outputPanel rendered="#{empty searchResultsBean.searchResults}">
                    <div class="no-results">
                        <div class="no-results-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h2 class="no-results-title">No Results Found</h2>
                        <p class="no-results-text">
                            We couldn't find any events matching "#{searchResultsBean.searchQuery}"
                        </p>

                        <div class="suggestions">
                            <div class="suggestions-title">Try these suggestions:</div>
                            <ul>
                                <li>Check your spelling</li>
                                <li>Try different keywords</li>
                                <li>Search by artist name (e.g., "Coldplay")</li>
                                <li>Search by category (e.g., "Music", "Sports")</li>
                                <li>Search by date (e.g., "2025-12-25")</li>
                                <li>Use broader search terms</li>
                            </ul>
                        </div>
                    </div>
                </p:outputPanel>
            </h:form>
        </div>

        <!-- Footer -->
        <div class="footer">
            © 2025 EventEase. All rights reserved.
        </div>
    </h:body>
</html>